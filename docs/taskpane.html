<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Word AI Assistant</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    * { box-sizing: border-box; }
    :root {
      --primary: #0078d4;
      --primary-dark: #005a9e;
      --success: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --bg: #f0f2f5;
      --card: white;
      --text: #1a1a1a;
      --text-muted: #666;
      --border: #e0e0e0;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 13px;
      color: var(--text);
      background: var(--bg);
      height: 100vh;
      overflow: hidden;
    }
    
    #app {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    /* Header */
    .header {
      padding: 8px 12px;
      background: linear-gradient(135deg, #1e3a5f 0%, #0d1b2a 100%);
      color: white;
      flex-shrink: 0;
    }
    
    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .header h1 { margin: 0; font-size: 14px; font-weight: 600; }
    
    .header-buttons { display: flex; gap: 4px; }
    
    .header-btn {
      background: rgba(255,255,255,0.15);
      border: none;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 10px;
      display: flex;
      align-items: center;
      gap: 3px;
    }
    
    .header-btn:hover { background: rgba(255,255,255,0.25); }
    .header-btn svg { width: 12px; height: 12px; }
    
    /* Tabs */
    .tabs {
      display: flex;
      background: white;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }
    
    .tab {
      flex: 1;
      padding: 8px;
      text-align: center;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-muted);
      background: none;
      border: none;
      cursor: pointer;
      border-bottom: 2px solid transparent;
    }
    
    .tab:hover { color: var(--text); }
    .tab.active { color: var(--primary); border-bottom-color: var(--primary); }
    
    /* Tab Content */
    .tab-content { display: none; flex: 1; overflow-y: auto; }
    .tab-content.active { display: flex; flex-direction: column; }
    
    /* Quick Actions Tab */
    .quick-actions-list {
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    .quick-action-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      transition: all 0.15s;
    }
    
    .quick-action-item:hover { border-color: var(--primary); }
    
    .quick-action-item.customized { border-left: 3px solid var(--warning); }
    
    .qa-icon { font-size: 18px; }
    
    .qa-info { flex: 1; min-width: 0; }
    .qa-name { font-weight: 500; font-size: 12px; }
    .qa-desc { font-size: 10px; color: var(--text-muted); margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    
    .qa-buttons { display: flex; gap: 4px; }
    
    .qa-btn {
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 11px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .qa-btn.run {
      background: var(--primary);
      color: white;
    }
    .qa-btn.run:hover { background: var(--primary-dark); }
    
    .qa-btn.settings {
      background: #f5f5f5;
      color: var(--text-muted);
    }
    .qa-btn.settings:hover { background: #e8e8e8; color: var(--text); }
    
    /* Chat Tab */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }
    
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .message {
      padding: 8px 10px;
      border-radius: 8px;
      max-width: 95%;
      line-height: 1.4;
      font-size: 12px;
    }
    
    .message-label { font-size: 9px; font-weight: 700; text-transform: uppercase; margin-bottom: 3px; opacity: 0.7; }
    
    .message.user { align-self: flex-end; background: var(--primary); color: white; }
    .message.assistant { align-self: flex-start; background: var(--card); border: 1px solid var(--success); }
    .message.assistant .message-label { color: var(--success); }
    .message.system { align-self: center; background: #e8e8e8; color: var(--text-muted); text-align: center; }
    .message.error { background: #ffebee; border: 1px solid var(--danger); color: #c62828; }
    .message.tool { align-self: center; background: #fff3e0; border: 1px solid var(--warning); color: #e65100; font-size: 10px; }
    
    /* History item */
    .history-item {
      margin-top: 4px;
      padding: 6px 8px;
      background: rgba(0,0,0,0.03);
      border-radius: 4px;
      font-size: 10px;
    }
    
    .history-item button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 3px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 9px;
      margin-top: 4px;
    }
    
    .input-area {
      padding: 8px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 6px;
      background: var(--bg);
    }
    
    .input-area textarea {
      flex: 1;
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      resize: none;
      font-family: inherit;
      font-size: 13px;
      min-height: 44px;
      max-height: 120px;
    }
    
    .input-area textarea:focus { outline: none; border-color: var(--primary); }
    
    .send-btn {
      width: 44px;
      height: 44px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .send-btn:disabled { background: #ccc; cursor: not-allowed; }
    .send-btn svg { width: 18px; height: 18px; }
    
    /* Settings Tab */
    .settings-content { padding: 12px; }
    
    .settings-section {
      background: var(--card);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }
    
    .settings-section-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .form-row { margin-bottom: 12px; }
    .form-row:last-child { margin-bottom: 0; }
    
    .form-label {
      display: block;
      font-size: 11px;
      font-weight: 500;
      margin-bottom: 4px;
    }
    
    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 12px;
      font-family: inherit;
    }
    
    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    .form-textarea { min-height: 60px; resize: vertical; }
    
    .form-hint { font-size: 10px; color: var(--text-muted); margin-top: 3px; }
    
    /* Toggle */
    .toggle-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .toggle-row:last-child { border-bottom: none; }
    .toggle-info { flex: 1; }
    .toggle-title { font-size: 12px; font-weight: 500; }
    .toggle-desc { font-size: 10px; color: var(--text-muted); }
    
    .toggle-switch {
      position: relative;
      width: 36px;
      height: 20px;
    }
    .toggle-switch input { opacity: 0; width: 0; height: 0; }
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background: #ccc;
      border-radius: 20px;
      transition: 0.3s;
    }
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 14px;
      width: 14px;
      left: 3px;
      bottom: 3px;
      background: white;
      border-radius: 50%;
      transition: 0.3s;
    }
    .toggle-switch input:checked + .toggle-slider { background: var(--success); }
    .toggle-switch input:checked + .toggle-slider:before { transform: translateX(16px); }
    
    /* Danger button */
    .danger-btn {
      width: 100%;
      padding: 10px;
      background: rgba(244, 67, 54, 0.1);
      border: 1px solid rgba(244, 67, 54, 0.3);
      color: var(--danger);
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
    }
    .danger-btn:hover { background: rgba(244, 67, 54, 0.2); }
    
    /* Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }
    .modal-overlay.open { display: flex; }
    
    .modal {
      background: var(--card);
      border-radius: 12px;
      width: 100%;
      max-width: 420px;
      max-height: 90vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    .modal-header {
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }
    
    .modal-title { font-size: 15px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
    .modal-close { background: none; border: none; font-size: 22px; cursor: pointer; color: var(--text-muted); line-height: 1; }
    
    .modal-body { flex: 1; overflow-y: auto; padding: 16px; }
    
    .modal-footer {
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      flex-shrink: 0;
    }
    
    .modal-btn {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      border: none;
    }
    .modal-btn.primary { background: var(--primary); color: white; }
    .modal-btn.primary:hover { background: var(--primary-dark); }
    .modal-btn.secondary { background: #f0f0f0; color: var(--text); }
    .modal-btn.danger { background: none; color: var(--danger); }
    
    /* Accordion */
    .accordion { border: 1px solid var(--border); border-radius: 6px; margin-top: 12px; }
    .accordion-header {
      padding: 10px 12px;
      background: #f9f9f9;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .accordion-header:hover { background: #f0f0f0; }
    .accordion-body { display: none; padding: 12px; border-top: 1px solid var(--border); }
    .accordion.open .accordion-body { display: block; }
    .accordion-arrow { transition: transform 0.2s; }
    .accordion.open .accordion-arrow { transform: rotate(180deg); }
    
    /* Slider */
    .slider-container { margin: 8px 0; }
    .slider-labels { display: flex; justify-content: space-between; font-size: 9px; color: var(--text-muted); margin-bottom: 4px; }
    .slider {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #e0e0e0;
      appearance: none;
      cursor: pointer;
    }
    .slider::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
    }
    
    /* Segmented Control */
    .segmented { display: flex; border: 1px solid var(--border); border-radius: 6px; overflow: hidden; }
    .segmented-btn {
      flex: 1;
      padding: 8px 4px;
      border: none;
      background: white;
      cursor: pointer;
      font-size: 10px;
      border-right: 1px solid var(--border);
    }
    .segmented-btn:last-child { border-right: none; }
    .segmented-btn:hover { background: #f5f5f5; }
    .segmented-btn.active { background: var(--primary); color: white; }
    
    /* Icon Row */
    .icon-row { display: flex; gap: 6px; flex-wrap: wrap; }
    .icon-btn {
      width: 40px;
      height: 40px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .icon-btn:hover { border-color: var(--primary); }
    .icon-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
    
    /* Preset Dropdown */
    .preset-row {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }
    .preset-row select { flex: 1; }
    .preset-row button { padding: 8px 12px; }
    
    /* Preview Panel */
    .preview-panel {
      margin-top: 12px;
      padding: 10px;
      background: #f9f9f9;
      border: 1px solid var(--border);
      border-radius: 6px;
    }
    .preview-label { font-size: 10px; font-weight: 600; color: var(--text-muted); margin-bottom: 6px; }
    .preview-text { font-size: 11px; line-height: 1.5; font-style: italic; color: var(--text); }
    
    /* Status */
    .status {
      padding: 4px 12px;
      font-size: 10px;
      color: var(--text-muted);
      background: var(--bg);
      flex-shrink: 0;
    }
    
    /* Char counter */
    .char-counter { text-align: right; font-size: 10px; color: var(--text-muted); margin-top: 2px; }
    .char-counter.warn { color: var(--warning); }
    .char-counter.error { color: var(--danger); }
  </style>
</head>
<body>
  <div id="app">
    <header class="header">
      <div class="header-top">
        <h1>AI Writing Assistant</h1>
        <div class="header-buttons">
          <button class="header-btn" id="popout-btn" title="Pop out">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
              <polyline points="15 3 21 3 21 9"></polyline>
              <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
          </button>
          <button class="header-btn" id="history-btn" title="Version History">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </button>
        </div>
      </div>
    </header>
    
    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" data-tab="actions">Quick Actions</button>
      <button class="tab" data-tab="chat">Chat</button>
      <button class="tab" data-tab="settings">Settings</button>
    </div>
    
    <!-- Quick Actions Tab -->
    <div class="tab-content active" data-tab="actions">
      <div class="quick-actions-list" id="quick-actions-list">
        <!-- Populated by JS -->
      </div>
    </div>
    
    <!-- Chat Tab -->
    <div class="tab-content" data-tab="chat">
      <div class="chat-container">
        <div id="messages" class="messages"></div>
        <div class="input-area">
          <textarea id="user-input" placeholder="Type your request..." rows="2"></textarea>
          <button id="send-btn" class="send-btn" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Settings Tab -->
    <div class="tab-content" data-tab="settings">
      <div class="settings-content">
        <!-- AI Provider -->
        <div class="settings-section">
          <div class="settings-section-title">ü§ñ AI Provider</div>
          <div class="form-row">
            <label class="form-label">Provider</label>
            <select class="form-select" id="provider">
              <option value="openai">OpenAI (GPT-4o)</option>
              <option value="gemini">Google Gemini</option>
              <option value="claude">Anthropic Claude</option>
              <option value="local">Local / Custom</option>
            </select>
          </div>
          <div class="form-row">
            <label class="form-label">API Key</label>
            <input type="password" class="form-input" id="api-key" placeholder="Enter API key...">
          </div>
          <div id="local-settings" style="display:none;">
            <div class="form-row">
              <label class="form-label">Endpoint URL</label>
              <input type="text" class="form-input" id="local-url" placeholder="http://localhost:1234/v1/chat/completions">
            </div>
            <div class="form-row">
              <label class="form-label">Model Name</label>
              <input type="text" class="form-input" id="local-model" placeholder="local-model">
            </div>
          </div>
        </div>
        
        <!-- Global Instructions -->
        <div class="settings-section">
          <div class="settings-section-title">üìù Global Instructions</div>
          <div class="form-row">
            <label class="form-label">Custom System Prompt</label>
            <textarea class="form-textarea" id="custom-prompt" placeholder="Instructions applied to ALL actions..."></textarea>
          </div>
        </div>
        
        <!-- Glossary / Guardrails -->
        <div class="settings-section">
          <div class="settings-section-title">üö´ Glossary & Guardrails</div>
          <div class="form-row">
            <label class="form-label">Always Replace (one per line: old ‚Üí new)</label>
            <textarea class="form-textarea" id="glossary-replace" placeholder="utilize ‚Üí use&#10;customer ‚Üí partner&#10;leverage ‚Üí use"></textarea>
            <div class="form-hint">Format: "old word ‚Üí new word" on each line</div>
          </div>
          <div class="form-row">
            <label class="form-label">Never Use (words/phrases to avoid)</label>
            <textarea class="form-textarea" id="glossary-avoid" placeholder="synergy&#10;circle back&#10;low-hanging fruit"></textarea>
          </div>
        </div>
        
        <!-- Export/Import -->
        <div class="settings-section">
          <div class="settings-section-title">üíæ Backup & Restore</div>
          <p style="font-size:11px;color:var(--text-muted);margin-bottom:12px;">Export your settings to a file, or import a previously saved configuration.</p>
          <div style="display:flex;gap:8px;">
            <button class="modal-btn primary" id="export-settings" style="flex:1;">
              <span style="margin-right:4px;">üì§</span> Export Settings
            </button>
            <label class="modal-btn secondary" style="flex:1;cursor:pointer;text-align:center;">
              <span style="margin-right:4px;">üì•</span> Import Settings
              <input type="file" id="import-settings" accept=".json" style="display:none;">
            </label>
          </div>
          <div id="import-status" style="margin-top:8px;font-size:11px;"></div>
        </div>
        
        <!-- Privacy -->
        <div class="settings-section">
          <div class="settings-section-title">üîí Privacy</div>
          <div class="toggle-row">
            <div class="toggle-info">
              <div class="toggle-title">Save API Key</div>
              <div class="toggle-desc">Remember between sessions</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="privacy-save-key">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-row">
            <div class="toggle-info">
              <div class="toggle-title">Save Action Presets</div>
              <div class="toggle-desc">Remember customizations</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="privacy-save-presets">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-row">
            <div class="toggle-info">
              <div class="toggle-title">Context Awareness</div>
              <div class="toggle-desc">Read surrounding text for better results</div>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="context-awareness" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <button class="danger-btn" id="clear-data" style="margin-top:12px;">Clear All Saved Data</button>
        </div>
      </div>
    </div>
    
    <!-- Action Settings Modal -->
    <div class="modal-overlay" id="action-modal">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">
            <span id="modal-icon">üîç</span>
            <span id="modal-action-name">Configure Action</span>
          </div>
          <button class="modal-close" id="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Preset Selection -->
          <div class="preset-row">
            <select class="form-select" id="modal-preset">
              <option value="">-- Load Preset --</option>
              <option value="academic">Academic Rigor</option>
              <option value="marketing">Marketing Blast</option>
              <option value="eli5">ELI5 Explainer</option>
              <option value="technical">Technical Doc</option>
            </select>
            <button class="modal-btn secondary" id="modal-save-preset">Save as Preset</button>
          </div>
          
          <!-- Core Parameters -->
          <div class="form-row">
            <label class="form-label">Tone & Voice</label>
            <select class="form-select" id="modal-tone">
              <option value="neutral">Neutral / Objective</option>
              <option value="persuasive">Persuasive / Sales</option>
              <option value="empathetic">Empathetic / Support</option>
              <option value="authoritative">Authoritative / Instructional</option>
              <option value="witty">Witty / Conversational</option>
            </select>
          </div>
          
          <div class="form-row">
            <label class="form-label">Length Constraint</label>
            <div class="segmented" id="modal-length">
              <button class="segmented-btn" data-value="spark">Spark (25%)</button>
              <button class="segmented-btn" data-value="concise">Concise (50%)</button>
              <button class="segmented-btn active" data-value="maintain">Maintain</button>
              <button class="segmented-btn" data-value="elaborate">Elaborate (150%)</button>
              <button class="segmented-btn" data-value="deep">Deep (200%)</button>
            </div>
          </div>
          
          <div class="form-row">
            <label class="form-label">Formality Spectrum</label>
            <div class="slider-container">
              <div class="slider-labels">
                <span>Chat/SMS</span>
                <span>Blog</span>
                <span>Business</span>
                <span>Whitepaper</span>
                <span>Legal</span>
              </div>
              <input type="range" class="slider" id="modal-formality" min="1" max="5" value="3">
            </div>
          </div>
          
          <div class="form-row">
            <label class="form-label">Output Structure</label>
            <div class="icon-row" id="modal-structure">
              <button class="icon-btn active" data-value="paragraphs" title="Paragraphs">¬∂</button>
              <button class="icon-btn" data-value="bullets" title="Bullet List">‚Ä¢</button>
              <button class="icon-btn" data-value="numbered" title="Numbered Steps">1.</button>
              <button class="icon-btn" data-value="table" title="Table">‚ñ¶</button>
              <button class="icon-btn" data-value="markdown" title="Markdown">MD</button>
            </div>
          </div>
          
          <div class="form-row">
            <label class="form-label">Complexity / Reading Level</label>
            <div class="segmented" id="modal-complexity">
              <button class="segmented-btn" data-value="5">5th Grade</button>
              <button class="segmented-btn" data-value="8">8th Grade</button>
              <button class="segmented-btn active" data-value="12">12th Grade</button>
              <button class="segmented-btn" data-value="16">Post-Grad</button>
            </div>
          </div>
          
          <!-- Custom Instructions -->
          <div class="form-row">
            <label class="form-label">Custom Instructions (for this action)</label>
            <textarea class="form-textarea" id="modal-instructions" maxlength="280" placeholder="e.g., 'Focus on benefits of Ryzen' or 'Avoid using synergy'"></textarea>
            <div class="char-counter" id="modal-char-count">0 / 280</div>
          </div>
          
          <!-- Advanced Options -->
          <div class="accordion" id="modal-advanced">
            <div class="accordion-header">
              Advanced Options
              <span class="accordion-arrow">‚ñº</span>
            </div>
            <div class="accordion-body">
              <div class="form-row">
                <label class="form-label">Jargon Density</label>
                <div class="segmented" id="modal-jargon">
                  <button class="segmented-btn" data-value="none">ELI5 (None)</button>
                  <button class="segmented-btn active" data-value="standard">Standard</button>
                  <button class="segmented-btn" data-value="high">Industry Veteran</button>
                </div>
              </div>
              
              <div class="form-row">
                <label class="form-label">Voice Construction</label>
                <div class="segmented" id="modal-voice">
                  <button class="segmented-btn" data-value="active">Active Voice</button>
                  <button class="segmented-btn active" data-value="mixed">Mixed</button>
                  <button class="segmented-btn" data-value="passive">Passive Voice</button>
                </div>
              </div>
              
              <div class="form-row">
                <label class="form-label">Revision Depth</label>
                <div class="slider-container">
                  <div class="slider-labels">
                    <span>Surface</span>
                    <span>Structural</span>
                    <span>Conceptual</span>
                  </div>
                  <input type="range" class="slider" id="modal-revision" min="1" max="3" value="2">
                </div>
              </div>
              
              <div class="form-row">
                <label class="form-label">Citation Style</label>
                <select class="form-select" id="modal-citation">
                  <option value="none">No Citations</option>
                  <option value="links">Embedded Links</option>
                  <option value="apa">APA Format</option>
                  <option value="chicago">Chicago Style</option>
                  <option value="mla">MLA</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- Live Preview -->
          <div class="preview-panel">
            <div class="preview-label">Live Preview</div>
            <div class="preview-text" id="modal-preview">
              <em>Original:</em> "The computer is fast."<br>
              <em>Result:</em> <span id="preview-result">The computer operates at high speed.</span>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn danger" id="modal-reset">Reset</button>
          <button class="modal-btn secondary" id="modal-cancel">Cancel</button>
          <button class="modal-btn primary" id="modal-apply">Apply & Run</button>
        </div>
      </div>
    </div>
    
    <!-- Version History Modal -->
    <div class="modal-overlay" id="history-modal">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">üìú Version History</div>
          <button class="modal-close" id="history-close">&times;</button>
        </div>
        <div class="modal-body">
          <div id="history-list" style="max-height: 400px; overflow-y: auto;">
            <p style="color: var(--text-muted); text-align: center; padding: 20px;">No history yet. Run an action to see previous versions here.</p>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn danger" id="history-clear">Clear History</button>
          <button class="modal-btn secondary" id="history-done">Done</button>
        </div>
      </div>
    </div>
    
    <div id="status" class="status">Ready</div>
  </div>
  
  <script src="taskpane.js"></script>
</body>
</html>
