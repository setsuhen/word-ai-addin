(()=>{"use strict";var e={942(e,n,t){t.d(n,{A:()=>i});var o=t(601),r=t.n(o),s=t(314),a=t.n(s)()(r());a.push([e.id,"* {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;\n  font-size: 14px;\n  color: #1a1a1a;\n  background: #f5f5f7;\n  height: 100vh;\n  overflow: hidden;\n}\n\n#app {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n/* Header */\n.header {\n  padding: 16px;\n  background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);\n  color: white;\n  flex-shrink: 0;\n}\n\n.header h1 {\n  margin: 0 0 4px 0;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.subtitle {\n  margin: 0 0 12px 0;\n  font-size: 12px;\n  opacity: 0.85;\n}\n\n.api-key-section {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.api-key-section label {\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.api-key-section input {\n  padding: 8px 12px;\n  border: 1px solid rgba(255,255,255,0.3);\n  border-radius: 6px;\n  background: rgba(255,255,255,0.1);\n  color: white;\n  font-size: 13px;\n}\n\n.api-key-section input::placeholder {\n  color: rgba(255,255,255,0.5);\n}\n\n.api-key-section input:focus {\n  outline: none;\n  border-color: #4a9eff;\n  box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.3);\n}\n\n.hint {\n  font-size: 11px;\n  opacity: 0.7;\n}\n\n/* Chat */\n.chat-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  padding: 12px;\n}\n\n.messages {\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  padding-bottom: 8px;\n}\n\n.message {\n  padding: 10px 14px;\n  border-radius: 12px;\n  max-width: 95%;\n  line-height: 1.5;\n  animation: fadeIn 0.2s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(4px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.message.user {\n  align-self: flex-end;\n  background: #0078d4;\n  color: white;\n}\n\n.message.assistant {\n  align-self: flex-start;\n  background: white;\n  border: 1px solid #e0e0e0;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.06);\n}\n\n.message.system {\n  align-self: center;\n  background: #f0f0f0;\n  color: #666;\n  font-size: 12px;\n}\n\n.message.error {\n  background: #fde8e8;\n  border: 1px solid #f5c6cb;\n  color: #721c24;\n}\n\n/* Input area */\n.input-area {\n  display: flex;\n  gap: 8px;\n  align-items: flex-end;\n  flex-shrink: 0;\n  padding-top: 8px;\n  border-top: 1px solid #e5e5e5;\n}\n\n.input-area textarea {\n  flex: 1;\n  padding: 10px 14px;\n  border: 1px solid #d0d0d0;\n  border-radius: 8px;\n  resize: none;\n  font-family: inherit;\n  font-size: 14px;\n  line-height: 1.4;\n  max-height: 100px;\n}\n\n.input-area textarea:focus {\n  outline: none;\n  border-color: #0078d4;\n  box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);\n}\n\n.send-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 18px;\n  background: #0078d4;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  flex-shrink: 0;\n  transition: background 0.15s;\n}\n\n.send-btn:hover:not(:disabled) {\n  background: #106ebe;\n}\n\n.send-btn:active:not(:disabled) {\n  background: #005a9e;\n}\n\n.send-btn:disabled {\n  background: #c0c0c0;\n  cursor: not-allowed;\n}\n\n.send-btn.loading {\n  pointer-events: none;\n  opacity: 0.8;\n}\n\n/* Status */\n.status {\n  padding: 6px 12px;\n  font-size: 11px;\n  color: #666;\n  flex-shrink: 0;\n  min-height: 20px;\n}\n",""]);const i=a},314(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,o,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);o&&a[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),t&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=t):u[2]=t),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),n.push(u))}},n}},601(e){e.exports=function(e){return e[1]}},72(e){var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var s={},a=[],i=0;i<e.length;i++){var c=e[i],d=o.base?c[0]+o.base:c[0],u=s[d]||0,l="".concat(d," ").concat(u);s[d]=u+1;var p=t(l),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)n[p].references++,n[p].updater(f);else{var m=r(f,o);o.byIndex=i,n.splice(i,0,{identifier:l,updater:m,references:1})}a.push(l)}return a}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var s=o(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var i=t(s[a]);n[i].references--}for(var c=o(e,r),d=0;d<s.length;d++){var u=t(s[d]);0===n[u].references&&(n[u].updater(),n.splice(u,1))}s=c}}},659(e){var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},540(e){e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},56(e,n,t){e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var s=t.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},113(e){e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var s=n[o]={id:o,exports:{}};return e[o](s,s.exports,t),s.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var o=t(72),r=t.n(o),s=t(825),a=t.n(s),i=t(659),c=t.n(i),d=t(56),u=t.n(d),l=t(540),p=t.n(l),f=t(113),m=t.n(f),h=t(942),g={};g.styleTagTransform=m(),g.setAttributes=u(),g.insert=c().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=p(),r()(h.A,g),h.A&&h.A.locals&&h.A.locals;const y=()=>window.Word||window.Office?.Word,x="word-ai-openai-key",b=[{type:"function",function:{name:"delete_all_instances_of_text",description:"Delete every instance of a specific word or phrase from the document. Use when the user wants to remove all occurrences of text.",parameters:{type:"object",properties:{searchText:{type:"string",description:"The exact word or phrase to find and delete"}},required:["searchText"]}}},{type:"function",function:{name:"replace_all_text",description:"Replace every instance of a search string with a replacement string. Use for find-and-replace operations.",parameters:{type:"object",properties:{searchText:{type:"string",description:"The text to find"},replaceText:{type:"string",description:"The text to replace it with"}},required:["searchText","replaceText"]}}},{type:"function",function:{name:"insert_text_at_end",description:"Insert text at the end of the document.",parameters:{type:"object",properties:{text:{type:"string",description:"The text to insert"}},required:["text"]}}},{type:"function",function:{name:"insert_text_at_start",description:"Insert text at the beginning of the document.",parameters:{type:"object",properties:{text:{type:"string",description:"The text to insert"}},required:["text"]}}},{type:"function",function:{name:"get_document_content",description:"Get the current text content of the document. Use when you need to read or analyze what is in the document before making edits.",parameters:{type:"object",properties:{}}}}];async function v(e,n){switch(e){case"delete_all_instances_of_text":return async function(e){if(!e||"string"!=typeof e)return{success:!1,count:0,message:"searchText must be a non-empty string."};const n=y();return n?n.run(async t=>{const o=t.document.body.search(e,{matchCase:!1});o.load("items"),await t.sync();const r=o.items;for(let e=r.length-1;e>=0;e--)r[e].insertText("",n.InsertLocation.replace);return await t.sync(),{success:!0,count:r.length,message:`Deleted ${r.length} instance(s) of "${e}".`}}):{success:!1,count:0,message:"Word is not ready."}}(n.searchText);case"replace_all_text":return async function(e,n){if(!e||"string"!=typeof e)return{success:!1,count:0,message:"searchText must be a non-empty string."};null==n&&(n="");const t=y();return t?t.run(async o=>{const r=o.document.body.search(e,{matchCase:!1});r.load("items"),await o.sync();const s=r.items;for(let e=s.length-1;e>=0;e--)s[e].insertText(n,t.InsertLocation.replace);return await o.sync(),{success:!0,count:s.length,message:`Replaced ${s.length} instance(s) of "${e}" with "${n}".`}}):{success:!1,count:0,message:"Word is not ready."}}(n.searchText,n.replaceText);case"insert_text_at_end":return async function(e){if(!e||"string"!=typeof e)return{success:!1,message:"text must be a non-empty string."};const n=y();return n?n.run(async t=>(t.document.body.insertText(e,n.InsertLocation.end),await t.sync(),{success:!0,message:"Inserted text at end of document."})):{success:!1,message:"Word is not ready."}}(n.text);case"insert_text_at_start":return async function(e){if(!e||"string"!=typeof e)return{success:!1,message:"text must be a non-empty string."};const n=y();return n?n.run(async t=>(t.document.body.insertText(e,n.InsertLocation.start),await t.sync(),{success:!0,message:"Inserted text at start of document."})):{success:!1,message:"Word is not ready."}}(n.text);case"get_document_content":return async function(){const e=y();return e?e.run(async e=>{const n=e.document.body;return n.load("text"),await e.sync(),{success:!0,content:(n.text||"").slice(0,4e3)}}):{success:!1,content:""}}();default:return{success:!1,message:`Unknown tool: ${e}`}}}async function w(e,n){const t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"gpt-4o-mini",messages:n,tools:b,tool_choice:"auto"})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error?.message||`API error: ${t.status}`)}return t.json()}function _(e,n,t=""){const o=document.getElementById("messages"),r=document.createElement("div");r.className=`message ${e} ${t}`.trim(),r.textContent=n,o.appendChild(r),o.scrollTop=o.scrollHeight}function k(e){document.getElementById("status").textContent=e}function T(e){const n=document.getElementById("send-btn");n.disabled=!e,n.classList.toggle("loading",!e)}Office.onReady(e=>{if(e.host!==Office.HostType.Word)return void(document.body.innerHTML="<p>This add-in only works in Word.</p>");const n=document.getElementById("api-key"),t=localStorage.getItem(x);t&&(n.value=t),n.addEventListener("change",()=>{localStorage.setItem(x,n.value)});const o=document.getElementById("user-input"),r=document.getElementById("send-btn"),s=()=>{const e=n.value.trim().length>0,t=o.value.trim().length>0;r.disabled=!(e&&t)};n.addEventListener("input",s),o.addEventListener("input",s),s();let a=[{role:"system",content:"You are an AI assistant that helps users edit their Word document. You have access to tools that can:\n- delete_all_instances_of_text: Remove every occurrence of a word or phrase\n- replace_all_text: Find and replace text throughout the document\n- insert_text_at_end: Add text at the end\n- insert_text_at_start: Add text at the beginning\n- get_document_content: Read the document's text\n\nWhen the user asks you to make edits, use the appropriate tools. You can use get_document_content first if you need to see what's in the document. Be concise in your responses. After performing an action, briefly confirm what you did."}];r.addEventListener("click",async()=>{const e=o.value.trim();if(!e)return;const t=n.value.trim();if(t){localStorage.setItem(x,t),o.value="",s(),_("user",e),T(!1),k("Thinking..."),a.push({role:"user",content:e});try{let e=!0;for(;e;){const n=await w(t,a),o=n.choices?.[0];if(!o)throw new Error("No response from API");const r=o.message;if(r.tool_calls&&r.tool_calls.length>0){a.push(r);for(const e of r.tool_calls){const n=e.function?.name;let t,o={};try{o=JSON.parse(e.function?.arguments||"{}")}catch(e){}k(`Running: ${n}...`),_("system",`⟳ ${n}(${JSON.stringify(o)})`,"system");try{t=await v(n,o)}catch(e){t={success:!1,message:e.message}}const r="object"==typeof t?JSON.stringify(t):String(t);a.push({role:"tool",tool_call_id:e.id,content:r}),_("system",`✓ ${t.message||(t.content?`Retrieved ${(t.content||"").length} chars`:r)}`,"system"),k("Edits applied. Continue processing...")}}else _("assistant",r.content?.trim()||"Done."),a.push({role:"assistant",content:r.content||""}),e=!1,k("Ready")}}catch(e){_("system",`Error: ${e.message}`,"error"),k("Error"),a.pop()}finally{T(!0)}}else _("system","Please enter your OpenAI API key.","error")}),o.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r.click())}),_("system",'Enter your OpenAI API key above, then describe the edits you want. Example: "Delete every instance of the word square"',"system")})})();